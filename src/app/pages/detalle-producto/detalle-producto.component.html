<!-- Loading State -->
<div *ngIf="loading" class="loading-container">
    <div class="container">
        <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Cargando...</span>
            </div>
            <p class="mt-3">Cargando producto...</p>
        </div>
    </div>
</div>

<!-- Error State -->
<div *ngIf="error && !loading" class="error-container">
    <div class="container">
        <div class="text-center py-5">
            <i class="fas fa-exclamation-triangle fa-3x text-warning mb-3"></i>
            <h3>Producto no encontrado</h3>
            <p class="text-muted mb-4">El producto que buscas no existe o ha sido eliminado.</p>
            <button class="btn btn-primary" (click)="goBack()">
                <i class="fas fa-arrow-left me-2"></i>Volver al catálogo
            </button>
        </div>
    </div>
</div>

<!-- Product Detail -->
<div *ngIf="product && !loading" class="product-detail-container">
    <div class="container">
        <div class="row g-4">
            <!-- Product Image -->
            <div class="col-lg-6 col-md-12">
                <div class="product-image-section">
                    <div class="main-image-container">
                        <img [src]="product.image" [alt]="product.name" class="img-fluid mx-auto d-block main-product-image">
                    </div>
                </div>
            </div>

            <!-- Product Info -->
            <div class="col-lg-6 col-md-12">
                <div class="product-info-section">
                    <!-- Header with Category and Heart Icon -->
                    <div class="product-header d-flex justify-content-between align-items-start mb-3">
                        <div class="badges-container">
                            <span class="category-badge fs-7 fs-6-sm">{{product.category}}</span>
                            <span class="stock-badge ms-2 fs-7 fs-6-sm">{{product.stock}} en stock</span>
                        </div>

                    </div>

                    <!-- Product Title -->
                    <h1 class="product-title mb-3 fs-2 fs-1-lg">{{product.name}}</h1>
                    
                    <!-- Price -->
                    <div class="price-section mb-4">
                        <span class="current-price fs-1 display-6 display-5-lg">S/{{product.price}}</span>
                    </div>

                    <!-- Description -->
                    <div class="description-section mb-4">
                        <p class="product-description">{{product.description}}</p>
                    </div>

                    <!-- Quantity Selector -->
                    <div class="quantity-section mb-4">
                        <label class="form-label fw-semibold mb-2">Cantidad:</label>
                        <div class="quantity-controls d-flex d-sm-flex align-items-center">
                            <button class="btn btn-outline-secondary quantity-btn" (click)="decreaseQuantity()"
                                [disabled]="quantity <= 1">
                                <i class="fas fa-minus"></i>
                            </button>
                            <input type="number" class="form-control quantity-input mx-2" [(ngModel)]="quantity" [min]="1"
                                [max]="product.stock" readonly>
                            <button class="btn btn-outline-secondary quantity-btn" (click)="increaseQuantity()"
                                [disabled]="quantity >= product.stock">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Add to Cart Button -->
                    <div class="action-buttons mb-4">
                        <button class="btn btn-primary btn-lg add-to-cart-btn w-100" (click)="addToCart()"
                            [disabled]="!product.inStock">
                            <i class="fas fa-shopping-cart me-2"></i>
                            Agregar al Carrito - S/{{(product.price * quantity).toFixed(2)}}
                        </button>
                    </div>

                    <!-- Product Features -->
                    <div class="features-section">
                        <h5 class="features-title mb-3">Información del producto</h5>
                        <div class="features-list">
                            <div class="feature-item">
                                <div class="feature-icon">
                                    <i class="fas fa-shipping-fast"></i>
                                </div>
                                <div class="feature-content">
                                    <div class="feature-title">Envío gratis</div>
                                    <div class="feature-subtitle">En pedidos mayores a S/50</div>
                                </div>
                            </div>
                            <div class="feature-item">
                                <div class="feature-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="feature-content">
                                    <div class="feature-title">Entrega rápida</div>
                                    <div class="feature-subtitle">2-3 días hábiles</div>
                                </div>
                            </div>
                            <div class="feature-item">
                                <div class="feature-icon">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <div class="feature-content">
                                    <div class="feature-title">Garantía de calidad</div>
                                    <div class="feature-subtitle">30 días de garantía</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>