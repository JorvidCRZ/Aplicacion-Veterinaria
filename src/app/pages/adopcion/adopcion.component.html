<div class="container my-5 contenedor-adopcion">
  <h1 class="text-center">Mascotas en Adopción</h1>
  <div class="texto">
    <p class="text-center">
      Encuentra tu compañero perfecto. Todas nuestras mascotas están vacunadas,
      desparasitadas y listas para encontrar un hogar lleno de amor.
    </p>
  </div>

  <!-- Indicador de carga -->
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-warning" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
    <p class="mt-3">Cargando mascotas...</p>
  </div>

  <!-- Contenido principal -->
  <div *ngIf="!loading">
    <div class="row">
      <div class="col-lg-3 col-md-4">
        <app-filtro-mascota
          (filtrosCambiados)="onFiltrosCambiados($event)"
          (limpiarFiltrosEvent)="onLimpiarFiltros()"
        ></app-filtro-mascota>
      </div>

      <div class="col-lg-9 col-md-8">
        <h6 class="mb-4">
          <span class="text-secondary">{{ mascotasFiltradas.length }}</span>
          mascotas disponibles
        </h6>

        <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-3">
          <div class="col" *ngFor="let mascota of mascotasFiltradas">
            <app-mascota-card
              [mascota]="mascota"
              (adoptarMascotaEvent)="adoptarMascota($event)"
            ></app-mascota-card>
          </div>
        </div>

        <!-- Mensaje cuando no hay mascotas -->
        <div
          *ngIf="mascotasFiltradas.length === 0 && !loading"
          class="text-center py-5"
        >
          <h4 class="text-muted">
            No se encontraron mascotas con los filtros seleccionados
          </h4>
          <p class="text-muted">
            Intenta ajustar los filtros para ver más resultados
          </p>
          <button class="btn btn-outline-warning" (click)="onLimpiarFiltros()">
            Limpiar filtros
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal Solicitud de Adopción -->
<div *ngIf="mostrarModalAdopcion" class="modal-overlay" (click)="cerrarModalAdopcion()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    
    <!-- Encabezado -->
    <div class="modal-header-custom d-flex justify-content-between align-items-start">
      <h5 class="modal-title fw-bold mb-0">
        Solicitud de Adopción - <span class="text-primary">{{ mascotaSeleccionada?.nombre }}</span>
      </h5>
      <button type="button" class="btn-close-custom" (click)="cerrarModalAdopcion()" aria-label="Cerrar">
        ×
      </button>
    </div>

    <!-- Cuerpo -->
    <div class="modal-body-custom">
      <p class="text-muted mb-4">
        Completa este formulario para solicitar la adopción de <strong>{{ mascotaSeleccionada?.nombre }}</strong>.  
        Revisaremos tu solicitud y nos pondremos en contacto contigo.
      </p>

      <!-- Formulario -->
      <form>
        <div class="row g-3 mb-3">
          <div class="col-md-6">
            <label class="form-label">Experiencia con mascotas</label>
            <select class="form-select" [(ngModel)]="formularioAdopcion.experiencia" name="experiencia">
              <option value="" disabled selected>Selecciona tu experiencia</option>
              <option value="Primera vez">Primera vez</option>
              <option value="Algo de experiencia">Algo de experiencia</option>
              <option value="Muy experimentado">Muy experimentado</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">Tipo de vivienda</label>
            <select class="form-select" [(ngModel)]="formularioAdopcion.tipoVivienda" name="tipoVivienda">
              <option value="" disabled selected>Selecciona tu vivienda</option>
              <option value="Apartamento">Apartamento</option>
              <option value="Casa">Casa</option>
              <option value="Casa con patio">Casa con patio</option>
              <option value="Finca">Finca</option>
              <option value="Granja">Granja</option>
            </select>
          </div>
        </div>

        <div class="mb-3">
          <label class="form-label">¿Tienes otras mascotas?</label>
          <textarea class="form-control" rows="2" placeholder="Describe las mascotas que tienes actualmente (si las hay)" 
                    [(ngModel)]="formularioAdopcion.otrasMascotas" name="otrasMascotas"></textarea>
        </div>

        <div class="mb-3">
          <label class="form-label">Horario de trabajo</label>
          <input type="text" class="form-control" placeholder="Ej: 9:00 AM - 5:00 PM, trabajo desde casa, etc."
                 [(ngModel)]="formularioAdopcion.horarioTrabajo" name="horarioTrabajo">
        </div>

        <div class="mb-3">
          <label class="form-label">¿Por qué quieres adoptar a <span class="text-primary">{{ mascotaSeleccionada?.nombre }}</span>?</label>
          <textarea class="form-control" rows="3" placeholder="Cuéntanos por qué sientes que eres la persona ideal para adoptar a esta mascota"
                    [(ngModel)]="formularioAdopcion.motivoAdopcion" name="motivoAdopcion"></textarea>
        </div>

        <div class="row g-3 mb-3">
          <div class="col-md-6">
            <label class="form-label">Contacto de emergencia</label>
            <input type="text" class="form-control" placeholder="Nombre y teléfono"
                   [(ngModel)]="formularioAdopcion.contactoEmergencia" name="contactoEmergencia">
          </div>
          <div class="col-md-6">
            <label class="form-label">Veterinario de referencia</label>
            <input type="text" class="form-control" placeholder="Nombre y contacto (opcional)"
                   [(ngModel)]="formularioAdopcion.veterinarioReferencia" name="veterinarioReferencia">
          </div>
        </div>

        <div class="form-check mb-2">
          <input class="form-check-input" type="checkbox" id="terminos" 
                 [(ngModel)]="formularioAdopcion.aceptaTerminos" name="aceptaTerminos">
          <label class="form-check-label" for="terminos">
            Acepto los términos y condiciones de adopción y me comprometo a brindar un hogar amoroso y responsable
          </label>
        </div>
        <div class="form-check mb-4">
          <input class="form-check-input" type="checkbox" id="visita" 
                 [(ngModel)]="formularioAdopcion.aceptaVisita" name="aceptaVisita">
          <label class="form-check-label" for="visita">
            Acepto recibir una visita domiciliaria como parte del proceso de adopción
          </label>
        </div>

        <div class="d-flex justify-content-end gap-2">
          <button type="button" class="btn btn-outline-secondary" (click)="cerrarModalAdopcion()">Cancelar</button>
          <button type="button" class="btn btn-primary" >Enviar Solicitud</button>
        </div>
      </form>
    </div>

  </div>
</div>

